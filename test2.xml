<group name="custom_test,">

  <!-- ══════════════════════════════════════════════════════════════
       CodecNet — Sample Custom Rules for Import Testing
       Rule IDs: 100100–100110
       Docs: https://documentation.wazuh.com/current/user-manual/ruleset/custom-rules.html
       ══════════════════════════════════════════════════════════════ -->

  <!-- ─── SSH Rules ─────────────────────────────────────────────── -->

  <rule id="100100" level="5">
    <if_group>syslog</if_group>
    <match>Failed password</match>
    <description>Custom: SSH failed password attempt detected.</description>
    <group>custom_test,authentication_failed,</group>
  </rule>

  <rule id="100101" level="10" frequency="5" timeframe="60">
    <if_matched_sid>100100</if_matched_sid>
    <description>Custom: SSH brute-force — 5 failed logins in 60 seconds.</description>
    <group>custom_test,authentication_failures,brute_force,</group>
    <mitre>
      <id>T1110</id>
    </mitre>
  </rule>

  <rule id="100102" level="3">
    <if_group>syslog</if_group>
    <match>Accepted password</match>
    <description>Custom: SSH login accepted with password.</description>
    <group>custom_test,authentication_success,</group>
  </rule>

  <!-- ─── Sudo / Privilege Escalation ───────────────────────────── -->

  <rule id="100103" level="8">
    <if_group>syslog</if_group>
    <match>sudo: .* COMMAND=</match>
    <description>Custom: Sudo command executed by user.</description>
    <group>custom_test,sudo,</group>
    <mitre>
      <id>T1548.003</id>
    </mitre>
  </rule>

  <rule id="100104" level="12">
    <if_group>syslog</if_group>
    <regex>sudo:.*NOT in sudoers</regex>
    <description>Custom: Unauthorized sudo attempt — user not in sudoers.</description>
    <group>custom_test,sudo,privilege_escalation,</group>
    <mitre>
      <id>T1548</id>
    </mitre>
  </rule>

  <!-- ─── File Integrity ─────────────────────────────────────────── -->

  <rule id="100105" level="7">
    <if_group>syscheck</if_group>
    <match>/etc/passwd</match>
    <description>Custom: Modification detected in /etc/passwd.</description>
    <group>custom_test,syscheck,integrity_changed,</group>
    <mitre>
      <id>T1098</id>
    </mitre>
  </rule>

  <rule id="100106" level="7">
    <if_group>syscheck</if_group>
    <match>/etc/shadow</match>
    <description>Custom: Modification detected in /etc/shadow.</description>
    <group>custom_test,syscheck,integrity_changed,</group>
    <mitre>
      <id>T1003.008</id>
    </mitre>
  </rule>

  <!-- ─── Web / HTTP ──────────────────────────────────────────────── -->

  <rule id="100107" level="6">
    <if_group>web-log</if_group>
    <regex>\.\.\/|\.\.\\</regex>
    <description>Custom: Path traversal attempt detected in HTTP request.</description>
    <group>custom_test,web,attack,</group>
    <mitre>
      <id>T1083</id>
    </mitre>
  </rule>

  <rule id="100108" level="9">
    <if_group>web-log</if_group>
    <regex>(\bUNION\b.*\bSELECT\b|\bSELECT\b.*\bFROM\b.*\bWHERE\b)</regex>
    <description>Custom: Possible SQL injection attempt detected in HTTP request.</description>
    <group>custom_test,web,attack,sql_injection,</group>
    <mitre>
      <id>T1190</id>
    </mitre>
  </rule>

  <!-- ─── Process / Command ──────────────────────────────────────── -->

  <rule id="100109" level="10">
    <if_group>syslog</if_group>
    <regex>nc -e|ncat.*--exec|bash -i|/dev/tcp/</regex>
    <description>Custom: Possible reverse shell command detected.</description>
    <group>custom_test,attack,reverse_shell,</group>
    <mitre>
      <id>T1059</id>
    </mitre>
  </rule>

  <rule id="100110" level="5">
    <if_group>syslog</if_group>
    <match>useradd</match>
    <description>Custom: New user account created on the system.</description>
    <group>custom_test,adduser,account_management,</group>
    <mitre>
      <id>T1136.001</id>
    </mitre>
  </rule>

</group>
